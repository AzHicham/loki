<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1660" height="1061"><desc>title%20Diagram%20of%20Realtime%20Handling%20in%20Loki%0A%0Aactor%20RabbitMq%0A%0Aparticipant%20RabbitMq_Worker%0Aparticipant%20Master_Worker%0A%0Aparticipant%20LoadBalancer_Worker%0Aparticipant%20Compute_Worker%0A%0ARabbitMq-%3ERabbitMq_Worker%3A%20rt_consumer.next()%0Aspace%20%0ARabbitMq_Worker-%3EMaster_Worker%3A**amqp_message_sender**%20%3D%3D%3E%20**amqp_message_receiver**%0A%0Aspace%0Anote%20over%20Master_Worker%3A%20**STOP**%20LoadBalancer%20to%20stop%20%5Cn%20-%20All%20Compute_Workers%20%5Cn%20-%20Listening%20ZMQ%0AMaster_Worker-%3ELoadBalancer_Worker%3A**load_balancer_order_sender**%20%3D%3D%3E%20**load_balancer_order_receiver**%0A%0Aloop%20%0Anote%20over%20LoadBalancer_Worker%2C%20Compute_Worker%3A%20Stop%20receiving%20PT%20request%2C%20%5Cnwait%20until%20all%20Compute_Workers%20are%20freed%0Aend%0A%0Aspace%0Anote%20over%20LoadBalancer_Worker%3A%20Send%20**STATE%3A%3ASTOPPED**%20to%20Master_Worker%0A%0ALoadBalancer_Worker-%3E%20Master_Worker%3A**load_balancer_state_sender**%20%3C%3D%3D%20**load_balancer_state_receiver**%0A%0Aspace%0Anote%20over%20Master_Worker%3A%20Handle%20realtime%20messages%0A%0Aspace%0Anote%20over%20Master_Worker%3A%20Restart%20LoadBlancer%20%5Cn%20-%20All%20Computer_Workers%20%5Cn%20-%20Listening%20ZMQ%0A%0AMaster_Worker-%3ELoadBalancer_Worker%3A**load_balancer_order_sender**%20%3D%3D%3E%20**load_balancer_order_receiver**%0A%0Anote%20over%20LoadBalancer_Worker%3A%20SeT%20**STATE%3A%3ARUNNING**%20to%20Master_Worker</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1660" height="1061"/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="16.5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="625.2817471601163" y="22.6179738" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Diagram of Realtime Handling in Loki</text></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 42.18932612587891 118.895148942 L 42.18932612587891 1061.310723942" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 221.43239777998048 118.895148942 L 221.43239777998048 1061.310723942" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 700.1087847111817 118.895148942 L 700.1087847111817 1061.310723942" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1259.351852550586 118.895148942 L 1259.351852550586 1061.310723942" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1573.863820842383 118.895148942 L 1573.863820842383 1061.310723942" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/></g><g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 50.784156169878905 55.112462826000005 A 8.594830044 8.594830044 0 1 1 50.78415187246424 55.10386799738847 M 42.18932612587891 63.70729287 L 42.18932612587891 82.103244894 M 31.332698701878904 70.34189851800001 L 53.04595354987891 70.34189851800001 M 42.18932612587891 82.103244894 L 31.332698701878904 99.29290498200001 M 42.18932612587891 82.103244894 L 53.04595354987891 99.29290498200001" stroke-miterlimit="10" stroke-width="2.5633703640000003" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="7.5393246000000005" y="114.37155418200001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RabbitMq</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 140.9053992744453 78.182796102 L 301.9593962855156 78.182796102 L 301.9593962855156 118.89514894199999 L 140.9053992744453 118.89514894199999 L 140.9053992744453 78.182796102 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="157.26573365644532" y="103.816499742" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RabbitMq_Worker</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 629.1734495662422 78.182796102 L 771.0441198561211 78.182796102 L 771.0441198561211 118.89514894199999 L 629.1734495662422 118.89514894199999 L 629.1734495662422 78.182796102 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="645.5337839482422" y="103.816499742" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Master_Worker</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1163.5998479415352 78.182796102 L 1355.1038571596368 78.182796102 L 1355.1038571596368 118.89514894199999 L 1163.5998479415352 118.89514894199999 L 1163.5998479415352 78.182796102 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1179.9601823235353" y="103.816499742" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">LoadBalancer_Worker</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1494.5201528727364 78.182796102 L 1653.2074888120294 78.182796102 L 1653.2074888120294 118.89514894199999 L 1494.5201528727364 118.89514894199999 L 1494.5201528727364 78.182796102 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1510.8804872547364" y="103.816499742" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Compute_Worker</text></g></g><g><g><g><rect fill="white" stroke="none" x="60.032394345878934" y="149.052447342" width="143.55693521410157" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="62.29419172587893" y="162.623231622" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">rt_consumer.next()</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 42.18932612587891 168.654691302 L 209.0176432719805 168.654691302" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(221.43239777998048,168.654691302) translate(-221.43239777998048,-168.654691302)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 208.86685677998048 162.371920802 L 221.43239777998048 168.654691302 L 208.86685677998048 174.937461802 Z"/></g></g><g><g><rect fill="white" stroke="none" x="239.27546599998047" y="228.96928810199998" width="442.99025049120115" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="241.53726337998046" y="242.54007238199998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">amqp_message_sender</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="432.2539229258789" y="242.54007238199998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> ==&gt; </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="478.4872565135254" y="242.54007238199998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">amqp_message_receiver</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 221.43239777998048 248.571532062 L 687.6940302031817 248.571532062" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(700.1087847111817,248.571532062) translate(-700.1087847111817,-248.571532062)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 687.5432437111816 242.288761562 L 700.1087847111817 248.571532062 L 687.5432437111816 254.854302562 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 574.6820063670704 308.88612886199996 L 811.964778775293 308.88612886199996 L 825.535563055293 322.45691314199996 L 825.535563055293 373.724320422 L 574.6820063670704 373.724320422 L 574.6820063670704 308.88612886199996 M 811.964778775293 308.88612886199996 L 811.964778775293 322.45691314199996 L 825.535563055293 322.45691314199996" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="595.7921152470703" y="329.99623774200006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">STOP</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="639.5754480717774" y="329.99623774200006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> LoadBalancer to stop </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="595.7921152470703" y="345.07488694200003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> - All Compute_Workers </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="595.7921152470703" y="360.153536142" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> - Listening ZMQ</text></g><g><g><rect fill="white" stroke="none" x="717.9518529311817" y="396.342294222" width="523.5569313994043" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="720.2136503111817" y="409.9130785020001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">load_balancer_order_sender</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="951.2136503111817" y="409.9130785020001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> ==&gt; </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="997.4469838988282" y="409.9130785020001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">load_balancer_order_receiver</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 700.1087847111817 415.94453818200003 L 1246.937098042586 415.94453818200003" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1259.351852550586,415.94453818200003) translate(-1259.351852550586,-415.94453818200003)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1246.786311550586 409.661767682 L 1259.351852550586 415.94453818200003 L 1246.786311550586 422.22730868200006 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1245.781068270586 479.274864822 L 1573.863820842383 479.274864822 L 1587.434605122383 492.845649102 L 1587.434605122383 529.034407182 L 1245.781068270586 529.034407182 L 1245.781068270586 479.274864822 M 1573.863820842383 479.274864822 L 1573.863820842383 492.845649102 L 1587.434605122383 492.845649102" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1266.891177150586" y="500.384973702" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Stop receiving PT request, </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1266.891177150586" y="515.463622902" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">wait until all Compute_Workers are freed</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1081.7500806914602 611.9669777820001 L 1423.3828401297121 611.9669777820001 L 1436.9536244097121 625.5377620620001 L 1436.9536244097121 646.647870942 L 1081.7500806914602 646.647870942 L 1081.7500806914602 611.9669777820001 M 1423.3828401297121 611.9669777820001 L 1423.3828401297121 625.5377620620001 L 1436.9536244097121 625.5377620620001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1102.86018957146" y="633.077086662" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Send </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1144.4935246849855" y="633.077086662" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">STATE::STOPPED</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1282.6268559838136" y="633.077086662" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> to Master_Worker</text></g><g><g><rect fill="white" stroke="none" x="720.3351842300099" y="669.265844742" width="518.7902688017481" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="722.5969816100098" y="682.836629022" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">load_balancer_state_sender</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="951.2136503111817" y="682.836629022" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> &lt;== </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="997.4469838988282" y="682.836629022" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">load_balancer_state_receiver</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1259.351852550586 688.868088702 L 712.5235392191817 688.868088702" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(700.1087847111817,688.868088702) translate(-700.1087847111817,-688.868088702)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 712.6743257111817 682.585318202 L 700.1087847111817 688.868088702 L 712.6743257111817 695.150859202 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 581.1570086558887 749.1826855020001 L 805.4897764864746 749.1826855020001 L 819.0605607664746 762.7534697820001 L 819.0605607664746 783.8635786620001 L 581.1570086558887 783.8635786620001 L 581.1570086558887 749.1826855020001 M 805.4897764864746 749.1826855020001 L 805.4897764864746 762.7534697820001 L 819.0605607664746 762.7534697820001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="602.2671175358887" y="770.2927943820001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Handle realtime messages</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 588.0903430064747 844.1781754620001 L 798.5564421358887 844.1781754620001 L 812.1272264158887 857.7489597420001 L 812.1272264158887 909.0163670220002 L 588.0903430064747 909.0163670220002 L 588.0903430064747 844.1781754620001 M 798.5564421358887 844.1781754620001 L 798.5564421358887 857.7489597420001 L 812.1272264158887 857.7489597420001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="609.2004518864746" y="865.2882843420001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Restart LoadBlancer </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="609.2004518864746" y="880.3669335420001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> - All Computer_Workers </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="609.2004518864746" y="895.445582742" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> - Listening ZMQ</text></g><g><g><rect fill="white" stroke="none" x="717.9518529311817" y="931.6343408220001" width="523.5569313994043" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="720.2136503111817" y="945.2051251020001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">load_balancer_order_sender</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="951.2136503111817" y="945.2051251020001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> ==&gt; </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="997.4469838988282" y="945.2051251020001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">load_balancer_order_receiver</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 700.1087847111817 951.2365847820001 L 1246.937098042586 951.2365847820001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1259.351852550586,951.2365847820001) translate(-1259.351852550586,-951.2365847820001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1246.786311550586 944.9538142820002 L 1259.351852550586 951.2365847820001 L 1246.786311550586 957.5193552820001 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1086.1500784026418 973.8545585820002 L 1418.9828424185305 973.8545585820002 L 1432.5536266985305 987.4253428620002 L 1432.5536266985305 1008.5354517420002 L 1086.1500784026418 1008.5354517420002 L 1086.1500784026418 973.8545585820002 M 1418.9828424185305 973.8545585820002 L 1418.9828424185305 987.4253428620002 L 1432.5536266985305 987.4253428620002" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1107.2601872826417" y="994.9646674620002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">SeT </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1139.2435208702882" y="994.9646674620002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">STATE::RUNNING</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1278.226858272632" y="994.9646674620002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> to Master_Worker</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1206.576580350586 438.56251198200005 L 1626.639093042383 438.56251198200005 L 1626.639093042383 551.652380982 L 1206.576580350586 551.652380982 L 1206.576580350586 438.56251198200005 Z" stroke-miterlimit="10" stroke-width="2.154092742857143" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1206.576580350586 438.56251198200005 L 1206.576580350586 456.656891022 L 1265.2838779876465 456.656891022 L 1274.3310675076466 447.60970150200006 L 1274.3310675076466 438.56251198200005 L 1206.576580350586 438.56251198200005" stroke-miterlimit="10" stroke-width="2.154092742857143" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="1221.655229550586" y="450.625431342" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">loop</text></g></g><g/><g/><g/><g/><g/></g></svg>
